define([],function(){function e(t){return this instanceof e?(this.$subtitleList=t.$subtitleList.css({position:"relative"}),this.$lines=this.$subtitleList.find(".line"),this.$scrollBox=t.$scrollBox||this.$subtitleList.parents(".panel"),this.lineHeight=parseInt(this.$lines.eq(0).css("lineHeight")),this.subtitleBorderLeftWidth=parseInt(this.$subtitleList.css("borderLeftWidth")),this.initElements(t),this.initEvents(t),void(this.onSelect=t.onSelect)):new e(t)}var t=e.prototype;return t.tplStartElem='<span class="clip-share-start hidden" id="select_start" title="Clip start"></span>',t.tplEndElem='<span class="clip-share-end hidden" id="select_end" title="Clip end"></span>',t.tplBubble=$.trim($("#tplBubble").remove().html()),t.selectedLineClass="selected-line",t.selectedWordClass="selected-word",t.selectedSpaceClass="selected-space",t.highlightClass="word-highlight",t.selected,t.initElements=function(){this.$start=$(this.tplStartElem),this.$end=$(this.tplEndElem),this.$subtitleList.append(this.$start).append(this.$end),this.$lines.each(function(){var e=$(this),t=e.position();e.data({top:t.top})}),this.$bubble=$(this.tplBubble).hide(),this.$subtitleList.append(this.$bubble)},t.initEvents=function(){var e=this;e.$subtitleList.mousedown(function(t){var s=e.$subtitleList.offset();e.isSelecting=!e.$bubble.is(t.target)&&!$.contains(e.$bubble.get(0),t.target),e.isSelecting&&(e.mouseStartTop=t.pageY-s.top,e.mouseStartLeft=t.pageX-s.left,e.undoSelection())}),e.$subtitleList.mouseup(function(t){var s=e.$subtitleList.offset();e.isSelecting&&(e.mouseEndTop=t.pageY-s.top,e.mouseEndLeft=t.pageX-s.left,e.isSelecting=!1,e.showSelectionByCords(),$.isFunction(e.onSelect)&&e.onSelect(e.getSelectedTime()))})},t.undoSelection=function(){var e=this,t=e.$lines.filter("."+e.selectedLineClass).removeClass(e.selectedLineClass);t.children().removeClass(e.selectedWordClass+" "+e.selectedSpaceClass),e.hideSelectors(),e.hideBubble()},t.hideSelectors=function(){this.$start.hide(),this.$end.hide()},t.hideBubble=function(){this.$bubble.hide()},t.showSelectionByCords=function(){var e=this,t=e.$subtitleList.offset().left+parseInt(e.$subtitleList.css("borderLeftWidth")),s=!0;e.$lines.each(function(){var i=$(this),l=i.data("top"),n=l+e.lineHeight>e.mouseEndTop;if(l+e.lineHeight>e.mouseStartTop){if(!(l<=e.mouseEndTop))return!1;i.addClass(e.selectedLineClass).children(".word, .space").each(function(){var i=$(this),l=i.width(),o=i.offset().left;if(!(s&&o+l/2-t<e.mouseStartLeft)){if(n&&o+l/2-t>e.mouseEndLeft)return!1;i.addClass(i.hasClass("word")?e.selectedWordClass:e.selectedSpaceClass)}}),s&&(s=!1)}}),e.clearDefaultSelection();var i=e.$subtitleList.find("."+e.selectedWordClass),l=e.$lines.filter("."+e.selectedLineClass),n=i.eq(0),o=i.eq(-1);i.length?(e.startTime=parseFloat(n.data("st")),e.endTime=parseFloat(o.data("et")),e.$start.css({left:i.eq(0).offset().left-t-e.$start.width(),top:l.eq(0).data("top")}).removeClass("hidden").show(),e.$end.css({left:o.offset().left+o.width()-t,top:l.eq(-1).data("top")+e.lineHeight-e.$end.height()}).removeClass("hidden").show(),e.$bubble.css({left:o.offset().left+o.width()-t-e.$bubble.width()/2,top:l.eq(-1).data("top")+e.lineHeight-e.$end.height()-e.$bubble.height()-12}).show()):(e.startTime=0,e.endTime=0,e.hideSelectors(),e.hideBubble())},t.clearDefaultSelection=function(){window.getSelection?window.getSelection().removeAllRanges():document.selection.empty()},t.turnToMark=function(){this.$subtitleList.find("."+this.selectedWordClass+", ."+this.selectedSpaceClass).addClass(this.highlightClass),this.undoSelection()},t.getSelectedTime=function(){return{start:this.startTime,end:this.endTime}},{subtitleSelect:e}});
//# sourceMappingURL=subtitleselect.js.map